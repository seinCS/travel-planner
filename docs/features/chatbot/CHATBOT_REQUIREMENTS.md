# 챗봇 기능 요구사항 명세서 (Final)

> **버전**: 1.2
> **작성일**: 2026-01-25
> **상태**: PRD 토론 완료, 아키텍처 설계 준비
> **다음 단계**: `/sc:design`

---

## Executive Summary

Travel Planner 프로젝트에 AI 챗봇 기능을 추가하여 사용자가 자연어로 장소를 추천받고, 여행 정보를 질문하며, 추천된 장소를 프로젝트에 바로 추가할 수 있는 대화형 어시스턴트를 제공합니다.

**핵심 가치**:
- 자연어 기반 장소 추천으로 여행 계획 간소화
- 프로젝트 통합으로 원스톱 여행 플래닝 경험 제공
- 향후 제휴 마케팅 확장을 통한 수익 모델 기반 마련

**MVP 범위**: 장소 추천 + 여행 Q&A + 대화 이력 저장 (1.5~2주)

---

## 변경 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0 | 2026-01-25 | 초안 작성 (브레인스토밍 완료) | - |
| 1.1 | 2026-01-25 | PRD 토론 반영 (예외 케이스, 보안, 비용 추가) | - |
| 1.2 | 2026-01-25 | PRD 토론 결과 반영 (20라운드 토론 완료) | - |

---

## 용어 사전

| 용어 | 정의 |
|------|------|
| TTFB | Time To First Byte - 첫 응답 바이트까지 시간 |
| SSE | Server-Sent Events - 서버→클라이언트 단방향 스트리밍 |
| Geocoding | 주소/장소명을 위도/경도 좌표로 변환 |
| 컨텍스트 윈도우 | AI 모델이 참조할 수 있는 이전 대화 범위 |

---

## 1. 개요

### 1.1 목표
프로젝트 상세 페이지에서 AI 챗봇을 통해 장소 추천, 여행 정보 Q&A를 제공하고, 추후 제휴 마케팅 창구로 확장 가능한 대화형 여행 어시스턴트 기능

### 1.2 핵심 결정 사항

| 항목 | 결정 |
|-----|-----|
| **핵심 목적** | 장소 추천 + 여행 Q&A + 제휴 링크 제공 |
| **UI 형태** | 플로팅 채팅 버튼 (우측 하단) |
| **표시 범위** | 프로젝트 상세 페이지만 |
| **세션 관리** | 프로젝트당 1개, 사용자별 개별 저장 |
| **그룹 공유** | 개별 - 각 멤버가 자신의 대화만 저장/조회 |
| **AI 모델** | Gemini Flash (전체 Gemini 마이그레이션 계획) |
| **응답 형식** | 카드 형태 (구조화) + 스트리밍 지원 |
| **언어** | 한국어 전용 |
| **사용 제한** | 일일 메시지 수 제한 (50회) |

### 1.3 성공 지표

| 지표 | 목표 | 측정 방법 |
|-----|-----|----------|
| 응답 시작 시간 (TTFB) | P50 < 1초, P95 < 2초 | APM 로그 |
| 장소 추가 전환율 | 측정 후 베이스라인 설정 | 추천 수 대비 추가 수 |
| 장소 추가 성공률 | > 95% | Geocoding 성공률 |
| 일일 활성 사용자 | 측정 시작, 1개월 후 DAU 50명 목표 | 고유 세션 수 |

---

## 2. 기능 요구사항

### 2.1 핵심 기능 (MVP)

#### FR-001: 장소 추천

**사용자 스토리 (US-001):**
> "여행자로서, '신주쿠 라멘집 추천해줘'라고 입력하면 AI가 적합한 장소를 추천하고 프로젝트에 추가할 수 있다"

**우선순위**: P0 (MVP 필수)

**수락 기준:**
- [ ] 자연어로 장소 추천 요청 가능
- [ ] 프로젝트 컨텍스트(destination, country) 자동 반영
- [ ] 추천 장소를 카드 형태로 표시
- [ ] 각 장소 카드에 [+ 추가] 버튼
- [ ] 장소 추가 시 Google Geocoding API로 좌표 획득 (기존 `geocodePlaceWithFallback()` 재사용)
- [ ] 추가된 장소는 프로젝트 장소 목록에 반영
- [ ] 이미 프로젝트에 있는 장소 추천 시 "이미 추가됨" 표시
- [ ] **[NEW] 추천 결과가 0개인 경우 "해당 조건에 맞는 장소를 찾지 못했어요. 다른 조건으로 검색해보세요." 메시지 표시**
- [ ] **[NEW] 중복 감지 시 기존 `DuplicateDetectionService` 활용**

**장소 카드 표시 정보:**
- 장소명
- 주소
- 카테고리 (restaurant, cafe, attraction 등)
- 설명/추천 이유 (3문장 이내)
- Google Maps 링크

---

#### FR-002: 여행 정보 Q&A

**사용자 스토리 (US-002):**
> "여행자로서, '일본 물가는 어때?', '교통패스 필요해?' 등 여행 관련 질문에 AI가 답변해준다"

**우선순위**: P0 (MVP 필수)

**수락 기준:**
- [ ] 환율, 교통, 날씨, 문화 팁, 음식/맛집 팁 5개 카테고리 질문에 응답 가능
- [ ] 응답은 관련성 있고, 문법적으로 올바르며, 5문장 이내
- [ ] 자연스러운 대화형 응답
- [ ] **[NEW] 실시간 정보 필요 질문 시 외부 링크 제공**
  - 환율: "최신 환율은 [네이버 금융](https://finance.naver.com)에서 확인해주세요"
  - 날씨: "정확한 날씨 예보는 [기상청](https://weather.go.kr)에서 확인해주세요"
- [ ] **[NEW] off-topic 질문 시 "여행 관련 질문만 도와드릴 수 있어요. 장소 추천이나 여행 팁에 대해 물어봐 주세요!" 응답**

---

#### FR-003: 제휴 링크 제공

**사용자 스토리 (US-003):**
> "여행자로서, 추천 장소와 함께 해당 장소의 Google Maps 링크를 바로 확인할 수 있다"

**우선순위**: P1 (MVP 포함, 부수적)

**수락 기준:**
- [ ] 장소 추천 시 Google Maps 링크 함께 표시
- [ ] 링크 클릭 시 새 탭에서 Google Maps 열림
- [ ] 향후 네이버 예약, 여행사 제휴 확장 가능한 구조

---

### 2.2 대화 관리

#### FR-004: 세션 관리

**우선순위**: P0

**수락 기준:**
- [ ] 프로젝트당 사용자별 1개 세션 유지
- [ ] 대화 이력 영구 저장 (프로젝트 삭제 시까지)
- [ ] 페이지 새로고침 후에도 대화 유지
- [ ] "새 대화 시작" 버튼으로 전체 초기화 가능
- [ ] 최근 10턴 대화까지 AI 컨텍스트 유지

---

#### FR-005: 컨텍스트 관리

**우선순위**: P0

**수락 기준:**
- [ ] 프로젝트의 destination, country 자동 주입
- [ ] 이전 대화 내용 기반 후속 질문 처리
- [ ] 컨텍스트 윈도우 초과 시 오래된 대화 자동 요약

---

### 2.3 UI/UX

#### FR-006: 플로팅 버튼

**우선순위**: P0

**수락 기준:**
- [ ] 화면 우측 하단에 고정 위치
- [ ] 챗봇 아이콘 버튼
- [ ] 클릭 시 채팅창 오픈/닫기 토글
- [ ] AI 서비스 장애 시 "점검 중" 배지 표시

---

#### FR-007: 채팅창

**우선순위**: P0

**수락 기준:**
- [ ] 데스크톱: 고정 크기 400px (너비) x 600px (높이)
- [ ] **[NEW] 모바일 (< 640px): 전체 화면 모드로 전환**
- [ ] 미니멀 카드 스타일 (깔끔한 흰색 배경, 둥근 모서리, 그림자)
- [ ] 헤더: 제목 + 닫기 버튼 + 새 대화 버튼
- [ ] 메시지 영역: 스크롤 가능
- [ ] 입력 영역: 텍스트 입력 + 전송 버튼

---

#### FR-008: 메시지 표시

**우선순위**: P0

**수락 기준:**
- [ ] 사용자 메시지: 우측 정렬, 색상 구분
- [ ] AI 응답: 좌측 정렬, 카드 형태
- [ ] 스트리밍 응답 지원 (실시간 타이핑 효과)
- [ ] 장소 추천 시 구조화된 카드 UI
- [ ] **[NEW] 터치 타겟 최소 크기 44px 이상 (모바일)**

---

#### FR-009: 시작 화면

**우선순위**: P1

**수락 기준:**
- [ ] 추천 질문 카드 표시 (3개)
- [ ] 예시: "라멘집 추천해줘", "교통패스 필요해?", "환율이 어때?"
- [ ] 카드 클릭 시 해당 질문 자동 전송

---

#### FR-010: 키보드/인터랙션

**우선순위**: P0

**수락 기준:**
- [ ] Enter 키로 메시지 전송
- [ ] 전송 중 입력 필드 비활성화
- [ ] 버튼, 입력 필드, 메시지 컨테이너에 aria-label 적용

---

### 2.4 추가 사용자 스토리

#### US-004: 오류 복구
> "여행자로서, 네트워크 오류 발생 시 '재시도' 버튼으로 마지막 메시지를 다시 전송할 수 있다"

#### US-005: 대안 추천
> "여행자로서, AI 추천이 적절하지 않을 때 '다른 추천' 요청으로 대안을 받을 수 있다"

**[NEW] 수락 기준:**
- [ ] "다른 추천해줘" 요청 시 이전에 추천한 장소는 제외
- [ ] 세션 내 추천 이력 추적하여 중복 추천 방지

#### US-006: 세션 유지
> "여행자로서, 대화창을 닫았다가 다시 열어도 이전 대화가 유지된다"

---

### 2.5 오류 처리 (FR-011)

**우선순위**: P0

**수락 기준:**
- [ ] API 오류 시 "응답 생성 실패" 메시지 표시
- [ ] 재시도 버튼 제공 (동일 messageId로 재시도, 최대 3회)
- [ ] 네트워크 오류 감지 및 안내

---

### 2.6 사용량 제한 (FR-012)

**우선순위**: P1

**수락 기준:**
- [ ] 일일 메시지 수 제한 (50회/일)
- [ ] **[NEW] 1회 = 사용자 메시지 전송 1건 (AI 에러 응답은 카운트 제외)**
- [ ] 제한 초과 시 안내 메시지
- [ ] 자정(KST) 기준 리셋
- [ ] 남은 사용량 표시 (선택)

---

## 3. 비기능 요구사항

### 3.1 성능 (NFR-001)

| 항목 | P50 목표 | P95 목표 | 측정 방법 |
|-----|---------|---------|----------|
| 첫 응답 시작 시간 (TTFB) | < 1초 | < 2초 | APM 로그 |
| 스트리밍 응답 지연 | < 100ms | < 200ms | 클라이언트 타임스탬프 |
| 장소 추가 응답 시간 | < 2초 | < 5초 | API 로그 |
| 채팅창 오픈 시간 | < 200ms | < 500ms | 클라이언트 측정 |

**[NEW] 부하 테스트 목표:**
- 50 concurrent users에서 P95 TTFB < 3초

### 3.2 안정성 (NFR-002)

- Gemini API 오류 시 graceful degradation
- 세션 복구 메커니즘 (DB 기반)
- 메시지 유실 방지 (서버 측 저장 우선)
- 스트리밍 중단 시 부분 응답 저장

### 3.3 보안 (NFR-003)

**인증/권한:**
- 사용자 인증 필수 (NextAuth 세션)
- 프로젝트 멤버만 해당 프로젝트 챗봇 접근
- API 키 서버사이드 관리

**입력 유효성 검사:**
- [ ] 최대 2000자 제한
- [ ] 빈 문자열 또는 공백만 있는 입력 차단
- [ ] HTML 태그 자동 이스케이프
- [ ] 프롬프트 인젝션 필터링 (금지 패턴 목록)
  - **[NEW] 예시**: "시스템 프롬프트 알려줘", "이전 지시 무시", "역할극 해줘"

**Rate Limiting:**
- [ ] 분당 10회 요청 제한 (per user)
- [ ] 초과 시 429 응답 + 대기 시간 안내

**출력 필터링:**
- [ ] AI 응답 URL은 화이트리스트 도메인만 허용 (google.com, naver.com, weather.go.kr, finance.naver.com)
- [ ] **[NEW] 마크다운 렌더링 시 DOMPurify 사용**

**로깅:**
- [ ] 서버 로그에 메시지 내용 기록 금지 (ID만 기록)
- [ ] **[NEW] 에러 로깅: session_id, error_code, timestamp만 기록**

### 3.4 모니터링 (NFR-004)

- 일일 메시지 수 통계
- 평균 응답 시간 측정
- 오류율 추적 (Gemini API, Geocoding)
- 장소 추가 전환율 추적

### 3.5 확장성 (NFR-005)

- 동시 사용자 1000명 지원 목표 (Vercel Pro 기준)
- Vercel 함수 타임아웃 60초 설정
- DB 연결 풀 최적화 (Prisma connection limit)

---

## 4. 예외 케이스 매트릭스

| 상황 | 시스템 반응 | 사용자 안내 |
|------|------------|------------|
| Gemini API 타임아웃 (10초) | 1회 자동 재시도 | "응답이 지연되고 있습니다..." 로딩 표시 |
| Gemini API 오류 | 에러 상태 저장 | "응답 생성에 실패했습니다" + 재시도 버튼 |
| Gemini API 다운 | 챗봇 버튼 비활성화 | "점검 중" 배지 표시 |
| Geocoding 실패 | 장소 카드에 경고 아이콘 | "위치를 찾을 수 없어요. 주소를 확인해주세요" |
| 이미 추가된 장소 추천 | 카드에 상태 표시 | "이미 추가됨" 라벨 + 추가 버튼 비활성화 |
| 컨텍스트 윈도우 초과 | 오래된 대화 자동 요약 | (자동, 사용자 안내 없음) |
| 사용량 제한 초과 | 입력 필드 비활성화 | "오늘 사용량을 초과했습니다. 내일 다시 이용해주세요" |
| 네트워크 끊김 | 마지막 상태 복구 시도 | "네트워크 연결을 확인해주세요" 토스트 |
| 중복 메시지 전송 | 동일 messageId 무시 | (자동, 사용자 안내 없음) |
| 스트리밍 중단 | 부분 응답 저장 | "응답이 중단되었습니다" + 재시도 버튼 |
| **[NEW] 프롬프트 인젝션 탐지** | 요청 차단, 로깅 | "이 요청을 처리할 수 없습니다" |
| **[NEW] 응답 토큰 초과 (2000)** | 응답 자르기 | (자동 종료, 안내 없음) |
| **[NEW] 추천 결과 0개** | 빈 응답 처리 | "해당 조건에 맞는 장소를 찾지 못했어요" |

---

## 5. 데이터 모델

### 5.1 새로 추가할 테이블

```prisma
model ChatSession {
  id        String   @id @default(cuid())
  projectId String
  userId    String

  project   Project  @relation(fields: [projectId], references: [id], onDelete: Cascade)
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  messages  ChatMessage[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([projectId, userId])  // 프로젝트+사용자당 1개 세션
  @@index([projectId])
  @@index([userId])
}

model ChatMessage {
  id          String   @id @default(cuid())
  sessionId   String
  role        String   // "user" | "assistant"
  content     String   @db.Text  // 최대 64KB 권장
  contentType String   @default("text")  // "text" | "places" | "error"
  status      String   @default("complete")  // [NEW] "streaming" | "complete" | "error"
  metadata    Json?    // 장소 추천 시 구조화된 데이터

  session     ChatSession @relation(fields: [sessionId], references: [id], onDelete: Cascade)

  // 메시지로 생성된 장소 참조
  createdPlaces Place[]

  createdAt DateTime @default(now())

  @@index([sessionId])
}

model ChatUsage {
  id        String   @id @default(cuid())
  userId    String
  date      DateTime @db.Date  // UTC 저장, KST 변환 시 +9시간

  count     Int      @default(0)

  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@unique([userId, date])
  @@index([userId])
}
```

### 5.2 기존 모델 수정

```prisma
model User {
  // 기존 필드 유지...

  chatSessions ChatSession[]
  chatUsage    ChatUsage[]
}

model Project {
  // 기존 필드 유지...

  chatSessions ChatSession[]
}

model Place {
  // 기존 필드 유지...

  // 챗봇에서 생성된 경우 메시지 참조
  createdByMessageId String?
  createdByMessage   ChatMessage? @relation(fields: [createdByMessageId], references: [id], onDelete: SetNull)
}
```

---

## 6. API 설계

### 6.1 채팅 API

```
POST /api/projects/[id]/chat
→ 메시지 전송, AI 응답 수신 (스트리밍)

Headers:
  Cookie: next-auth.session-token=...
  X-Request-Id: <uuid>  // 중복 방지용

Request:
{
  "message": "신주쿠 라멘집 추천해줘",
  "messageId": "client-uuid"  // 중복 전송 방지
}

Response: Server-Sent Events (SSE)
data: {"type": "text", "content": "신주쿠에서"}
data: {"type": "text", "content": " 인기있는"}
...
data: {"type": "place", "place": {...}}
data: {"type": "done", "messageId": "server-uuid"}

Error Response (SSE):
data: {"type": "error", "code": "AI_ERROR", "message": "응답 생성에 실패했습니다"}
```

```
GET /api/projects/[id]/chat/history
→ 대화 이력 조회

Response:
{
  "messages": [
    { "id": "...", "role": "user", "content": "...", "status": "complete", "createdAt": "..." },
    { "id": "...", "role": "assistant", "content": "...", "contentType": "places", "status": "complete", "metadata": {...}, "createdAt": "..." }
  ]
}
```

```
DELETE /api/projects/[id]/chat
→ 대화 초기화

Response:
{ "success": true }
```

### 6.2 장소 추가 API

```
POST /api/projects/[id]/chat/add-place
→ AI 추천 장소를 프로젝트에 추가

Request:
{
  "name": "후우운지",
  "name_en": "Fuunji",
  "address": "신주쿠구 요요기 2-14-3",
  "description": "농후한 츠케멘이 유명한 라멘집",
  "category": "restaurant",
  "messageId": "..."
}

Response:
{
  "place": { "id": "...", "latitude": 35.xxx, "longitude": 139.xxx, ... }
}

Error Response:
{
  "error": {
    "code": "GEOCODING_FAILED",
    "message": "위치를 찾을 수 없습니다"
  }
}
```

### 6.3 사용량 API

```
GET /api/chat/usage
→ 오늘 사용량 조회

Response:
{
  "used": 15,
  "limit": 50,
  "remaining": 35,
  "resetsAt": "2026-01-26T00:00:00+09:00"
}
```

### 6.4 에러 응답 표준

```json
{
  "error": {
    "code": "RATE_LIMIT_EXCEEDED | UNAUTHORIZED | FORBIDDEN | AI_ERROR | GEOCODING_FAILED | VALIDATION_ERROR | PROMPT_BLOCKED",
    "message": "사용자 친화적 메시지",
    "retryAfter": 3600
  }
}
```

**HTTP 상태 코드 매핑:**
| 에러 코드 | HTTP 상태 |
|----------|----------|
| UNAUTHORIZED | 401 |
| FORBIDDEN | 403 |
| VALIDATION_ERROR | 400 |
| PROMPT_BLOCKED | 400 |
| RATE_LIMIT_EXCEEDED | 429 |
| AI_ERROR | 502 |
| GEOCODING_FAILED | 422 |

---

## 7. 비용 분석

### 7.1 API 비용 예측

| 서비스 | 단가 | 월간 예상 사용량 | 월간 비용 |
|--------|------|-----------------|----------|
| Gemini Flash (입력) | $0.075/1M tokens | ~50M tokens | ~$3.75 |
| Gemini Flash (출력) | $0.30/1M tokens | ~100M tokens | ~$30 |
| Google Geocoding | $5/1000 req (200 무료) | ~5000 req | ~$24 |
| **합계** | | | **~$58/월** |

### 7.2 가정
- 일일 활성 사용자: 100명
- 사용자당 일일 메시지: 10회
- 메시지당 입력 토큰: ~500, 출력 토큰: ~1000
- 장소 추천 시 Geocoding 호출: 3회/추천

### 7.3 비용 시나리오

| 시나리오 | DAU | 메시지/일 | 월간 비용 |
|----------|-----|----------|----------|
| 낙관적 | 50 | 5 | ~$30 |
| 기본 | 100 | 10 | ~$58 |
| **최악** | 200 | 20 | ~$230 |

### 7.4 비용 알림 정책

| 임계값 | 조치 |
|--------|------|
| $50/월 초과 | 관리자 Slack 알림 |
| $100/월 초과 | 신규 사용자 일일 한도 30회로 감소 |
| $150/월 초과 | 긴급 검토 후 서비스 제한 결정 |

---

## 8. 리스크 매트릭스

| 리스크 | 확률 | 영향 | 대응 방안 |
|--------|------|------|----------|
| Gemini API 장애 | 낮음 | 높음 | 챗봇 비활성화 + "점검 중" 표시 |
| AI 추천 품질 불만 | 중간 | 높음 | 피드백 수집 + 프롬프트 개선 |
| Geocoding 실패율 높음 | 중간 | 중간 | 4단계 fallback + 수동 입력 옵션 |
| API 비용 폭증 | 낮음 | 중간 | 사용량 제한 + 알림 체계 |
| 프롬프트 인젝션 공격 | 낮음 | 높음 | 입력 필터링 + 금지 패턴 목록 |
| 경쟁 서비스 등장 | 높음 | 중간 | 프로젝트 통합이라는 차별점 강화 |
| **[NEW] 운영 리스크** | 중간 | 중간 | 정기 검증 + 모델 버전 고정 |

---

## 9. Phase 분류

### 9.1 MVP (Phase 1) - 1.5~2주

| ID | 기능 | 우선순위 |
|-----|-----|---------|
| FR-001 | 장소 추천 | P0 |
| FR-002 | 여행 Q&A | P0 |
| FR-004 | 세션 관리 | P0 |
| FR-005 | 컨텍스트 관리 | P0 |
| FR-006 | 플로팅 버튼 | P0 |
| FR-007 | 채팅창 UI | P0 |
| FR-008 | 메시지 표시 (스트리밍) | P0 |
| FR-010 | 키보드/인터랙션 | P0 |
| FR-011 | 오류 처리 | P0 |

### 9.2 MVP+ (Phase 1.5) - +0.5주

| ID | 기능 | 우선순위 |
|-----|-----|---------|
| FR-003 | 제휴 링크 | P1 |
| FR-009 | 시작 화면 (추천 질문) | P1 |
| FR-012 | 사용량 제한 | P1 |

### 9.3 Phase 2 (추후 구현)

| 기능 | 설명 |
|-----|-----|
| 일정 자동 생성 | "3박 4일 도쿄 여행" → Day별 일정 생성 |
| 일정 수정 요청 | "2일차에 카페 추가해줘" |
| 네이버 예약 제휴 | 식당/카페 예약 링크 |
| 여행사 제휴 | 항공/숙소 예약 링크 |
| 그룹 대화 공유 | 멤버 간 AI 추천 공유 옵션 |
| 기존 Claude → Gemini 마이그레이션 | 장소 추출 기능 (MVP 완료 후 3개월 내) |

---

## 10. 예상 구현 일정

```
Week 1: 기본 인프라 + 핵심 기능
├── Day 1: Gemini API 연동, 프롬프트 설계
├── Day 2-3: 데이터 모델, API 구현 (스트리밍)
├── Day 4-5: 플로팅 버튼, 채팅창 UI, 메시지 표시

Week 2: 장소 추가 + 마무리
├── Day 1-2: 장소 추천 카드 UI + 추가 기능 (Geocoding)
├── Day 3: 대화 이력, 세션 관리
├── Day 4-5: 오류 처리, 예외 케이스, 테스트

Week 2.5 (선택): MVP+ 기능
├── 사용량 제한
├── 추천 질문 카드
├── 모니터링 대시보드 기본

총 예상 기간: 2~2.5주
```

---

## 11. Open Questions (미해결 사항)

| # | 질문 | 담당 | 기한 |
|---|------|------|------|
| 1 | Gemini API 비용 최적화 (캐싱, 토큰 압축) | 개발팀 | Phase 1 완료 후 |
| 2 | 멀티모달 지원 (이미지 기반 장소 질문) | 기획팀 | Phase 3 검토 |
| 3 | 음성 입력 지원 | 기획팀 | Phase 3 검토 |
| 4 | 다국어 지원 확장 | 기획팀 | 글로벌 확장 시 |
| 5 | **[NEW] Feature flag 기반 롤아웃 도입** | 개발팀 | Phase 1 시작 시 |
| 6 | **[NEW] AI 추천 정확성 정기 검증 프로세스** | 운영팀 | Phase 1 완료 후 |

---

## 12. 부록: UI 와이어프레임

### 12.1 플로팅 버튼

```
┌──────────────────────────────────────────────────────────────────────┐
│  프로젝트 상세 페이지                                                  │
│                                                                        │
│  ... (기존 콘텐츠) ...                                                │
│                                                                        │
│                                                            ┌─────┐   │
│                                                            │ 💬  │   │
│                                                            └─────┘   │
└──────────────────────────────────────────────────────────────────────┘
```

### 12.2 채팅창 (시작 화면)

```
┌────────────────────────────────────┐
│  🤖 여행 어시스턴트          [↻][✕]│
├────────────────────────────────────┤
│                                    │
│  무엇이든 물어보세요!             │
│                                    │
│  ┌────────────────┐ ┌────────────┐│
│  │ 라멘집 추천    │ │ 교통패스?  ││
│  └────────────────┘ └────────────┘│
│  ┌────────────────┐               │
│  │ 환율이 어때?   │               │
│  └────────────────┘               │
│                                    │
├────────────────────────────────────┤
│  메시지를 입력하세요...     [전송] │
└────────────────────────────────────┘
```

### 12.3 장소 추천 응답

```
┌────────────────────────────────────┐
│  🤖 여행 어시스턴트          [↻][✕]│
├────────────────────────────────────┤
│         ┌────────────────────────┐ │
│         │ 신주쿠 라멘집 추천해줘 │ │
│         └────────────────────────┘ │
│                                    │
│  ┌──────────────────────────────┐  │
│  │ 🤖 신주쿠 라멘 맛집을        │  │
│  │    추천드릴게요!             │  │
│  │                              │  │
│  │  ┌──────────────────────┐   │  │
│  │  │ 🍜 후우운지            │   │  │
│  │  │ 📍 요요기 2-14-3      │   │  │
│  │  │ 🏷️ restaurant         │   │  │
│  │  │ 농후한 츠케멘 전문    │   │  │
│  │  │ 🔗 Google Maps        │   │  │
│  │  │           [+ 추가]    │   │  │
│  │  └──────────────────────┘   │  │
│  │                              │  │
│  │  ┌──────────────────────┐   │  │
│  │  │ 🍜 이치란 신주쿠점    │   │  │
│  │  │ 📍 가부키초 1-22-7    │   │  │
│  │  │ 🏷️ restaurant         │   │  │
│  │  │ 1인 부스 스타일       │   │  │
│  │  │ 🔗 Google Maps        │   │  │
│  │  │           [+ 추가]    │   │  │
│  │  └──────────────────────┘   │  │
│  └──────────────────────────────┘  │
│                                    │
├────────────────────────────────────┤
│  메시지를 입력하세요...     [전송] │
└────────────────────────────────────┘
```

---

*최종 업데이트: 2026-01-25*
*PRD 토론 완료 (20라운드), 최종 문서*
*토론 로그: docs/debate-logs/debate-2026-01-25-chatbot-v2.md*
