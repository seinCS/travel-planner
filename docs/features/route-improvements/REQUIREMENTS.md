# 경로 표시 개선 요구사항 명세

> 작성일: 2026-01-29
> 상태: 확정

## 개요

여행 플래너의 경로 표시 기능을 개선하기 위한 세 가지 요구사항을 정의합니다.

---

## 이슈 1: 숙소 경로 포함

### 배경
현재 숙소는 별도의 마커로만 표시되고, 경로(routePath)에서는 제외됩니다.
이로 인해 실제 이동 동선과 지도 경로가 일치하지 않는 문제가 있습니다.

### 목표
숙소를 경로의 경유지로 포함시켜 실제 이동 동선을 정확히 표시합니다.

### 기능 요구사항

| ID | 요구사항 | 우선순위 |
|----|----------|----------|
| FR1.1 | `accommodation_checkin`, `accommodation_checkout`, `accommodation_stay` 아이템도 `routePath`에 포함 | 필수 |
| FR1.2 | 숙소의 위도/경도를 사용하여 경로 계산 | 필수 |
| FR1.3 | 숙소에도 순서 번호 부여 (기존 장소와 동일하게) | 필수 |

### 동작 방식
- 일정에 따라 자동 포함
- 숙소 아이템(체크인/체크아웃/숙박)이 일정에 있는 위치에 따라 경로에 포함

### 예시
```
체크아웃 날: 숙소(체크아웃) → 장소1 → 장소2
일반 날: 장소1 → 장소2 → 장소3
체크인 날: 장소1 → 장소2 → 숙소(체크인)
```

---

## 이슈 2: 핀 숫자 중복 제거

### 배경
현재 지도에서 순서 숫자가 두 가지 방식으로 중복 표시됩니다:
1. 기본 Google Maps Marker의 `label` 속성
2. OverlayView 컴포넌트

### 목표
중복 표시를 제거하여 깔끔한 UI를 제공합니다.

### 기능 요구사항

| ID | 요구사항 | 우선순위 |
|----|----------|----------|
| FR2.1 | 기본 Google Maps Marker의 `label` 속성 제거 | 필수 |
| FR2.2 | OverlayView로만 순서 숫자 표시 | 필수 |
| FR2.3 | 숙소 마커에도 숫자 표시 (이슈1 연계) | 필수 |

### 동작 방식
- OverlayView만 사용하여 숫자 표시
- 기본 마커는 라벨 없이 표시

---

## 이슈 3: 대중교통 시간 표시

### 배경
현재 이동 시간은 도보(4.5km/h 기준)로만 계산됩니다.
장거리 이동 시 대중교통 시간을 확인할 수 없어 불편합니다.

### 목표
도보 + 대중교통 이동 시간을 모두 표시하고, 자동/수동 전환을 지원합니다.

### 기능 요구사항

| ID | 요구사항 | 우선순위 |
|----|----------|----------|
| FR3.1 | 도보 시간 계산 후 30분 이상 구간 식별 | 필수 |
| FR3.2 | 30분 이상 구간만 Google Directions API 호출 (transit mode) | 필수 |
| FR3.3 | API 결과 캐싱 (1분) | 필수 |
| FR3.4 | UI에 도보/대중교통 토글 버튼 추가 | 필수 |
| FR3.5 | 30분 미만 구간은 기존처럼 도보만 표시 | 필수 |

### 동작 방식

#### 자동 전환
- 도보 30분 이상 → 대중교통으로 자동 표시
- 도보 30분 미만 → 도보로 표시

#### 수동 전환
- 클릭으로 도보 ↔ 대중교통 전환 가능

### 비용 최적화
- 도보 30분 이상 구간만 API 호출하여 비용 절감
- 예: 5개 장소 중 2개 구간만 30분 이상이면 2회만 API 호출

### API 비용 참고
- Google Directions API: $0.005/호출
- 예상 비용: 하루 평균 2-3 구간 × $0.005 = $0.01~$0.015/일정

---

## 수락 기준 (Acceptance Criteria)

### 이슈 1
- [ ] 숙소가 있는 날짜의 경로에 숙소가 포함됨
- [ ] 숙소에도 순서 번호가 표시됨
- [ ] 숙소 전후 구간의 거리/시간이 계산됨

### 이슈 2
- [ ] 마커 위에 숫자가 하나만 표시됨
- [ ] OverlayView 스타일이 기존과 동일함

### 이슈 3
- [ ] 도보 30분 이상 구간에 대중교통 시간이 표시됨
- [ ] 도보 ↔ 대중교통 토글이 작동함
- [ ] API 캐싱이 정상 작동함 (1분)

---

## 다음 단계

1. `/sc:design` - 아키텍처 설계
2. `/sc:workflow` - 구현 워크플로우 생성
