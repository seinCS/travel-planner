# PRD 토론 로그: 챗봇 기능 요구사항 명세서

> **토론 일시**: 2026-01-25
> **대상 문서**: `docs/CHATBOT_REQUIREMENTS.md`
> **총 라운드**: 20

---

## 품질 점수 차트

```
Clarity (명확성)      : ████████░░ 4/5
Completeness (완전성) : ██████░░░░ 3/5
Feasibility (실현성)  : ████████░░ 4/5
Risk Coverage (리스크): ████░░░░░░ 2/5
─────────────────────────────────────
총점                  : 13/20 (65%)
최종 신뢰도           : 75%
```

---

## 핵심 인사이트 요약

### 주요 강점 (긍정적 기획자)
1. **명확한 사용자 가치**: "장소 추천 + 프로젝트 추가" 플로우가 직관적
2. **기술 스택 적합성**: Gemini Flash + SSE + Prisma 조합이 검증됨
3. **Phase 분리**: MVP와 Phase 2 구분으로 리스크 관리
4. **UI 와이어프레임**: ASCII 기반이지만 의도 전달 명확

### 주요 개선점 (부정적 기획자)
1. **예외 케이스 부족**: Geocoding 실패, 컨텍스트 초과, 중복 장소 처리 미정의
2. **보안 요구사항 미흡**: 프롬프트 인젝션, 입력 유효성 검사 없음
3. **비용 분석 부재**: API 비용 예측, 예산 한도 없음
4. **요구사항 ID 없음**: 추적 및 테스트 매핑 어려움

---

## 라운드별 상세 기록

### ROUND 1-3: 핵심 요구사항 및 범위

**토론 주제**: MVP 목표 분산 vs 집중

| 관점 | 주장 |
|------|------|
| 긍정 | 3가지 목표(장소 추천, Q&A, 제휴 링크)가 상호 보완적 |
| 부정 | MVP는 "장소 추천"에만 집중, Q&A/제휴는 P1으로 분리 권장 |

**합의 결과**: MVP 핵심을 장소 추천으로 하되, Q&A는 함께 포함 (제휴 링크는 부수적)

**PRD 업데이트 권장**:
- [ ] MVP 기능에 우선순위 태깅 (P0, P1, P2)
- [ ] 성공 지표 측정 방법 구체화

---

### ROUND 4-6: 사용자 스토리 및 수락 기준

**토론 주제**: 사용자 스토리 완전성

| 관점 | 주장 |
|------|------|
| 긍정 | 3개 핵심 스토리가 주요 가치 커버 |
| 부정 | 실패/중단/변경 시나리오 없음, 페르소나 단일 |

**합의 결과**: 부정 시나리오 및 다양한 페르소나 추가 필요

**PRD 업데이트 권장**:
- [ ] US-004~006 추가 (오류 복구, 대안 추천, 세션 유지)
- [ ] 수락 기준 구체화 ("자연스러운" → "5문장 이내, 관련성 있는")

---

### ROUND 7-9: 기술 아키텍처 및 정합성

**토론 주제**: 이중 AI 시스템(Claude + Gemini) 운영

| 관점 | 주장 |
|------|------|
| 긍정 | 기존 인프라 활용, Gemini Flash 비용 효율적 |
| 부정 | 이중 시스템 복잡도, Vercel 타임아웃 우려 |

**합의 결과**: MVP는 Gemini만 사용, 마이그레이션 타임라인 명시 필요

**PRD 업데이트 권장**:
- [ ] NFR: Vercel 함수 타임아웃 60초 설정
- [ ] 마이그레이션 계획 타임라인 추가
- [ ] ChatMessage에 contentType, metadata 필드 추가

---

### ROUND 10-12: 예외 케이스 및 에러 처리

**토론 주제**: 예외 케이스 정의 수준

| 관점 | 주장 |
|------|------|
| 긍정 | 기본 오류 처리(재시도, graceful degradation) 정의됨 |
| 부정 | 구체적 대응 방법 없음, 복구 전략 부재 |

**합의 결과**: 예외 케이스 매트릭스 필수 추가

**PRD 업데이트 권장**:
```
| 상황 | 시스템 반응 | 사용자 안내 |
|------|------------|------------|
| Gemini API 타임아웃 | 10초 후 1회 재시도 | "응답 지연 중..." |
| Gemini API 다운 | 챗봇 비활성화 | "일시적 사용 불가" 배지 |
| Geocoding 실패 | 카드에 경고 표시 | "위치를 찾을 수 없어요" |
| 컨텍스트 초과 | 오래된 대화 요약 | (자동, 안내 없음) |
```

---

### ROUND 13-15: 보안, 성능, 확장성

**토론 주제**: 보안 요구사항 수준

| 관점 | 주장 |
|------|------|
| 긍정 | NextAuth 인증, 권한 검증, API 키 보호 있음 |
| 부정 | 프롬프트 인젝션, 입력 유효성, 대화 암호화 없음 |

**합의 결과**: 보안 체크리스트 필수 추가

**PRD 업데이트 권장**:
```
입력 유효성 검사:
- [ ] 최대 2000자 제한
- [ ] 빈 문자열 차단
- [ ] 프롬프트 인젝션 필터링
- [ ] 분당 10회 요청 제한

보안 추가:
- [ ] AI 응답 URL 화이트리스트 도메인만 허용
- [ ] 서버 로그에 메시지 내용 기록 금지
```

---

### ROUND 16-18: 비용 효율성 및 비즈니스 리스크

**토론 주제**: 비용 분석 부재

| 관점 | 주장 |
|------|------|
| 긍정 | Gemini Flash는 비용 효율적, 사용량 제한으로 통제 가능 |
| 부정 | 구체적 비용 예측 없음, 예산 알림 없음 |

**합의 결과**: 비용 분석 섹션 신규 작성 필요

**PRD 업데이트 권장**:
```
비용 분석:
1. Gemini Flash API: ~$15/월 (10만 요청 기준)
2. Google Geocoding: ~$24/월 (5000회 초과 시)
3. 예산 알림: $50 초과 시 알림, $100 초과 시 제한 강화
```

---

### ROUND 19-20: 최종 검토 및 문서 정리

**토론 주제**: 문서 완전성

| 관점 | 주장 |
|------|------|
| 긍정 | 구조적이고 일관된 문서 |
| 부정 | 요구사항 ID 없음, 용어 사전 없음, 변경 이력 없음 |

**합의 결과**: 문서 형식 개선 필요

**PRD 업데이트 권장**:
- [ ] 요구사항 ID 체계 도입 (FR-001, NFR-001)
- [ ] 용어 사전 추가
- [ ] 변경 이력 섹션 추가
- [ ] Executive Summary 추가

---

## 최종 합의 상태

| 영역 | 합의 | 상태 |
|------|------|------|
| 핵심 목표 | 장소 추천 + Q&A 통합 | ✅ Yes |
| MVP 범위 | 스트리밍/사용량 제한 P1로 조정 권장 | 🔄 Partial |
| 기술 아키텍처 | Gemini Flash + SSE | ✅ Yes |
| 데이터 모델 | 3개 테이블 추가 | ✅ Yes |
| 예외 케이스 | 매트릭스 추가 필요 | ❌ No |
| 보안 요구사항 | 입력 검증/필터링 추가 필요 | ❌ No |
| 비용 분석 | 신규 작성 필요 | ❌ No |
| 성능 요구사항 | P50/P95 구분 필요 | 🔄 Partial |

---

## 다음 단계 권장 사항

1. **즉시 반영**: 예외 케이스 매트릭스, 입력 유효성 검사
2. **MVP 전 반영**: 비용 분석, 요구사항 ID
3. **Phase 2 전 반영**: 보안 강화 (암호화, 감사 로그)

---

*토론 완료: 2026-01-25*
